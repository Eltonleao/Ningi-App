!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{X3zk:function(n,r,i){"use strict";i.r(r),i.d(r,"LoginPageModule",(function(){return y}));var o,a,s,c=i("ofXK"),u=i("3Pt+"),l=i("TEn/"),d=i("tyNb"),p=i("mrSG"),h=i("Wcq6"),f=i("fXoL"),g=i("Oipj"),m=i("CqG3"),v=i("hLxd"),b=i("e8h1"),x=i("Sy1n"),w=i("up+p"),j=[{path:"",component:(o=function(){function n(t,r,i,o,a,s,c,u,l){var d=this;e(this,n),this.fAuth=t,this.afs=r,this.ningiService=i,this.storage=o,this.navCtrl=a,this.loadingController=s,this.app=c,this.gplus=u,this.platform=l,console.log("entrando em login page..."),this.user={displayName:"User",photoURL:"https://picsum.photos/200"},this.storage.get("user").then((function(e){e&&(d.user=e)}))}var r,i,o;return r=n,(i=[{key:"ngOnInit",value:function(){}},{key:"googleLogin",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadingController.create({spinner:"crescent"});case 2:return t=e.sent,e.next=5,t.present();case 5:if(!this.platform.is("cordova")){e.next=23;break}return e.next=8,console.log("login mobile");case 8:e.prev=8,this.gplus.login({}).then((function(e){return Object(p.a)(i,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.dismiss();case 2:return n.next=4,this.updateUserDataCordova(e);case 4:case"end":return n.stop()}}),n,this)})))})).catch((function(e){alert(e),console.error(e)})),e.next=21;break;case 12:return e.prev=12,e.t0=e.catch(8),console.log(e.t0),e.next=17,this.loadingController.create({message:e.t0,spinner:"crescent"});case 17:return t=e.sent,e.next=20,t.present();case 20:setTimeout((function(){t.dismiss()}),3e3);case 21:e.next=31;break;case 23:return n=new h.auth.GoogleAuthProvider,e.next=26,this.fAuth.auth.signInWithPopup(n);case 26:return r=e.sent,e.next=29,this.updateUserDataBrowser(r.user);case 29:return e.next=31,t.dismiss();case 31:case"end":return e.stop()}}),e,this,[[8,12]])})))}},{key:"updateUserDataCordova",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("updating user..."),(n=this).ningiService.getuser(e.email,(function(e){var t=this;console.log(e),e?n.storage.set("user",e).then((function(){return Object(p.a)(t,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.app.showMenu=!0,n.navCtrl.navigateRoot("tabs/dashboard");case 1:case"end":return e.stop()}}),e)})))})):alert("Oops, n\xe3o foi fazer o login, voc\xea precisa se cadastrar no sistema primeiro.")}));case 3:case"end":return t.stop()}}),t,this)})))}},{key:"updateUserDataBrowser",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={uid:e.email,login_tipo:"google",email:e.email,displayName:e.displayName,photoURL:e.photoURL,deletado:0},t.next=3,this.loadingController.create({spinner:"crescent"});case 3:return r=t.sent,t.next=6,r.present();case 6:return t.next=8,this.storage.set("user",n);case 8:return t.next=10,this.ningiService.updateUser(n).then((function(e){return Object(p.a)(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.navCtrl.navigateForward("/tabs/dashboard"),e.next=3,r.dismiss();case 3:case"end":return e.stop()}}),e,this)})))}));case 10:case"end":return t.stop()}}),t,this)})))}}])&&t(r.prototype,i),o&&t(r,o),n}(),o.\u0275fac=function(e){return new(e||o)(f["\u0275\u0275directiveInject"](g.AngularFireAuth),f["\u0275\u0275directiveInject"](m.AngularFirestore),f["\u0275\u0275directiveInject"](v.a),f["\u0275\u0275directiveInject"](b.b),f["\u0275\u0275directiveInject"](l.bb),f["\u0275\u0275directiveInject"](l.Z),f["\u0275\u0275directiveInject"](x.a),f["\u0275\u0275directiveInject"](w.a),f["\u0275\u0275directiveInject"](l.db))},o.\u0275cmp=f["\u0275\u0275defineComponent"]({type:o,selectors:[["app-login"]],decls:10,vars:0,consts:[["color","dark"],["slot","start",1,"menu-btn"],[1,"ion-text-center"],[1,"btn-container"],["fill","solid","expand","black","color","dark",3,"click"]],template:function(e,t){1&e&&(f["\u0275\u0275elementStart"](0,"ion-header"),f["\u0275\u0275elementStart"](1,"ion-toolbar",0),f["\u0275\u0275elementStart"](2,"ion-buttons",1),f["\u0275\u0275element"](3,"ion-menu-button"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](4,"ion-title",2),f["\u0275\u0275text"](5,"Login"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementStart"](6,"ion-content"),f["\u0275\u0275elementStart"](7,"div",3),f["\u0275\u0275elementStart"](8,"ion-button",4),f["\u0275\u0275listener"]("click",(function(){return t.googleLogin()})),f["\u0275\u0275text"](9,"Login com Google"),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"](),f["\u0275\u0275elementEnd"]())},directives:[l.t,l.W,l.h,l.D,l.V,l.o,l.g],styles:[".btn-container[_ngcontent-%COMP%]{text-align:center;justify-self:center;display:flex;justify-content:center;align-self:center;height:100%;align-items:center}"]}),o)}],k=((s=function t(){e(this,t)}).\u0275mod=f["\u0275\u0275defineNgModule"]({type:s}),s.\u0275inj=f["\u0275\u0275defineInjector"]({factory:function(e){return new(e||s)},imports:[[d.i.forChild(j)],d.i]}),s),y=((a=function t(){e(this,t)}).\u0275mod=f["\u0275\u0275defineNgModule"]({type:a}),a.\u0275inj=f["\u0275\u0275defineInjector"]({factory:function(e){return new(e||a)},imports:[[c.b,u.a,l.X,k]]}),a)}}])}();